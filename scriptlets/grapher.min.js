javascript:(()=>{"use strict";var __webpack_modules__={435:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function set_style(){let e=document.createElement("style"),t=".wx-fixed-t {position:sticky;top:0px;z-index:2}";t+=".wx-fixed-l {position:sticky;left:0px;z-index:2}",t+=".wx-fieldset {font-size: small; font-family: monospace; background: azure; border: 1px solid gray}",t+=".wx-form {width: max-content}",t+=".wx-fs-item {display: inline-grid; margin-right:10px}",t+='tr[class*="filter_hidden"] { display: none }',t+=".wx-pivot td {border: 1px solid grey; background-color: azure; padding:2px; white-space: nowrap}",t+=".wx-pivot table { color #363636; border-collapse: collapse; border-spacing: 0}",t+=".wx-pivot th {background-color: LightBlue; border: 1px solid grey; padding: 2px}",t+=".wx-pivot tbody tr:hover * {background-color: aliceblue}",e.innerHTML='.wx-fixed-t {position:sticky;top:0px;z-index:2}.wx-fixed-l {position:sticky;left:0px;z-index:2}.wx-fieldset {font-size: small; font-family: monospace; background: azure; border: 1px solid gray}.wx-form {width: max-content}.wx-fs-item {display: inline-grid; margin-right:10px}tr[class*="filter_hidden"] { display: none }.wx-pivot td {border: 1px solid grey; background-color: azure; padding:2px; white-space: nowrap}.wx-pivot table { color #363636; border-collapse: collapse; border-spacing: 0}.wx-pivot th {background-color: LightBlue; border: 1px solid grey; padding: 2px}.wx-pivot tbody tr:hover * {background-color: aliceblue}',document.head.append(e)}function get_heading(e){let t=e.children[0].children[0];return fix_table_heading(e),[...t.cells].map((e=>e.dataset.colName))}function fix_table_heading(e){let t=e.children[0].children[0];if(0==t.cells.length&&(t=e.children[0].children[1]),!t.classList.contains("wx-thead")){e.tHead||e.createTHead().appendChild(t),t.classList.add("wx-thead"),t.classList.add("wx-fixed-t"),t.style.zIndex=2;let l=t.cells;for(let e=0;e<l.length;e++)""==l[e].textContent&&(l[e].textContent="column"+e),l[e].setAttribute("data-col-name",l[e].textContent.replace("▾","").replace("▴","").trim())}let l=e.tBodies[0].rows,n=Math.min(l.length,3),i=[];for(let e=0;e<n;e++)(l[e].querySelector('a[title="Undo sorting"]')||l[e].querySelector('a[title="Sort alphabetically"]')||l[e].querySelector('a[title="Sort numerically"]')||l[e].querySelector('*[title="Sort Ascending"]')||l[e].querySelector('*[title="Sort Descending"]'))&&i.push(l[e]);i.forEach((t=>e.tHead.appendChild(t)))}function tbl_to_json(e,t=!1){let l=get_heading(e),n=e.tBodies[0].rows,i=[];for(let e=0;e<n.length;e++){let a={};if(0!=n[e].cells.length&&(1!=t||!n[e].className.includes("filter_hidden"))){for(let t=0;t<l.length;t++)a[l[t]]=n[e].cells[t].textContent;i.push(a)}}return i}function tbl_filter(e){fix_table_heading(e);var t=e.tHead.children[0].children;let l=Math.floor(100*Math.random()),n=document.createElement("caption");n.style.textAlign="left",n.style.fontFamily="monospace",e.appendChild(n);for(let n=0;n<t.length;n++){var i=document.createElement("input");let o=t[n].offsetWidth||50;i.style.width=o+"px",i.setAttribute("type","text"),i.setAttribute("placeholder","matches"),i.setAttribute("id","rf_id_"+n+"_"+l),i.onkeyup=function(t){13==t.keyCode&&(this.style.width=Math.max(11*this.value.length+6,45)+"px",filter_rows(e,this.value,n))},i.onkeydown=function(e){if(13==e.keyCode)return e.stopPropagation(),!1},i.onclick=function(e){e.stopPropagation()};var a=document.createElement("span");a.className="wx-thead-span",t[n].style.position="sticky",t[n].style.top="0px","rgba(0, 0, 0, 0)"==window.getComputedStyle(t[n],null).getPropertyValue("background-color")&&(t[n].style.backgroundColor="Gainsboro"),t[n].appendChild(i),t[n].appendChild(a)}}function filter_rows(e,t,l=0){let n=e.tBodies[0].children,i=[],a=[];fix_table_heading(e);let o=e.tHead.children[0].children,r="";for(let t=0;t<o.length;t++){let l=o[t].getElementsByTagName("input")[0].value;l.trim()?r+=" ["+o[t].firstChild.textContent+":"+l+"]":(a.push(t),e.tHead.children[0].children[t].querySelector(".wx-thead-span").textContent="")}for(let e=0;e<n.length;e++){for(let a of t.toLowerCase().split("|")){let t=n[e].children[l].textContent.toLowerCase().trim();if(a.startsWith("<")){let o=a.split("<")[1];t=t.replace(/[^0-9\.]/g,""),Number(t)<Number(o)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(a.startsWith(">")){t=t.replace(/[^0-9\.]/g,"");let o=a.split(">")[1];Number(t)>Number(o)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(a.startsWith("^")){let o=a.split("^")[1].toLowerCase();t.startsWith(o)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(a.startsWith("$")){let o=a.split("$")[1].toLowerCase();t.endsWith(o)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(a.startsWith("!")){let o=a.split("!")[1].toLowerCase();t.includes(o)||(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(a.startsWith("="))t==a.split("=")[1]&&(n[e].classList.remove("filter_hidden_"+l),i.push(e));else if(a.startsWith("@[")){let o=a.split("@[")[1].replace("]",""),r=Number(o.split(",")[0]),s=Number(o.split(",")[1]);t=Number(t.replace(/[^0-9\.]/g,"")),t>=r&&t<=s&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else t.includes(a)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}i.includes(e)||n[e].classList.add("filter_hidden_"+l),a.forEach((t=>{n[e].classList.remove("filter_hidden_"+t)}))}e.tHead.children[0].children[l].querySelector(".wx-thead-span").textContent="="+i.length;let s=n.length-e.tBodies[0].querySelectorAll('tr[class*="filter_hidden"]').length;e.caption.textContent="Total "+s+" rows visible; Filters ="+r}function pivot_table(tbl,x_h=[],y_h,xy_h,xy_f="flat",tbl_id=""){fix_table_heading(tbl);let h_l=get_heading(tbl),d=tbl.tBodies[0].rows,t_d=[];for(let e=0;e<d.length;e++){let t={};for(let l=0;l<h_l.length;l++)t[h_l[l]]=d[e].cells[l].textContent;t_d.push(t)}tbl.id+=" wx-orig"+tbl_id;let rest=h_l;rest=rest.filter((e=>e!=y_h&&e!=x_h)),rest=rest.filter((e=>!xy_h.includes(e)));let x_set=new Set;t_d.forEach((e=>{x_set.add(e[x_h])}));let x_l=[...x_set],y_d={};for(let e of y_h)y_d[e]=new Set,t_d.forEach((t=>{y_d[e].add(t[e])})),y_d[e]=[...y_d[e]];let r=new Map;for(let e of t_d){let t=[];for(let l of y_h)t.push(e[l]);r[t]||(r[t]={y:t,data:{},rest:{}});for(let l of rest)r[t].rest[l]||(r[t].rest[l]=new Set),r[t].rest[l].add(e[l]);for(let l of x_l){r[t].data[l]||(r[t].data[l]={});for(let n of xy_h)r[t].data[l][n]||(r[t].data[l][n]=[]),e[x_h]==l&&r[t].data[l][n].push(e[n])}}function filter_cols(e,t){let l=new Set;for(let n of t)if(""==e.trim())document.querySelectorAll('*[data-x-id="'+n+'"]').forEach((e=>e.hidden=!1));else{document.querySelectorAll('*[data-x-id="'+n+'"]').forEach((e=>e.hidden=!0));for(let n of e.split("|"))n.startsWith("^")?t.filter((e=>e.startsWith(n.split("^")[1]))).forEach(l.add,l):n.startsWith("$")?t.filter((e=>e.endsWith(n.split("$")[1]))).forEach(l.add,l):n.startsWith("!")?t.filter((e=>e!=n.split("!")[1])).forEach(l.add,l):n.startsWith("=")?t.filter((e=>e==n.split("=")[1])).forEach(l.add,l):t.filter((e=>e.toLowerCase().includes(n.toLowerCase()))).forEach(l.add,l)}if(l=[...l],""==!e.trim())for(let e of l)document.querySelectorAll('*[data-x-id="'+e+'"]').forEach((e=>e.hidden=!1))}let n_t=document.createElement("table");n_t.id=tbl_id,n_t.classList.add("wx-pivot");let th=n_t.createTHead();th.classList.add("wx-fixed-t");let thr1=th.insertRow();for(let e of y_h){let t=document.createElement("th");t.textContent=e,t.classList.add("wx-fixed-l"),t.classList.add("wx-fixed-t"),t.style.zIndex=3,thr1.appendChild(t)}let head_colspan=xy_h.length;for(let e of x_l){let t=document.createElement("th");t.setAttribute("colspan",head_colspan),t.setAttribute("data-x-id",e),t.classList.add("wx-fixed-t"),t.textContent=e,thr1.appendChild(t)}let thr2=th.insertRow(),thd=document.createElement("th");thd.setAttribute("colspan",y_h.length);var div=document.createElement("div"),span=document.createElement("span");span.textContent=x_h,div.appendChild(span);var cf_ip=document.createElement("input");div.appendChild(cf_ip),cf_ip.setAttribute("type","text"),cf_ip.setAttribute("placeholder",x_h+" matches"),cf_ip.setAttribute("id","x_id"),cf_ip.classList.add("wx-input-cf"),cf_ip.onkeyup=function(e){13==e.keyCode&&filter_cols(this.value,x_l)},cf_ip.onkeydown=function(e){if(13==e.keyCode)return!1},thd.append(div),thr2.append(thd);for(let e=0;e<x_l.length;e++)for(let t of xy_h){let l=document.createElement("th");l.setAttribute("data-x-id",x_l[e]),l.setAttribute("data-xy-id",t),l.textContent=t,thr2.appendChild(l)}let tb=document.createElement("tbody");n_t.appendChild(tb);for(let i in r){let tr=document.createElement("tr");tb.appendChild(tr);for(let e of r[i].y){let t=document.createElement("td");t.textContent=e,t.classList.add("wx-fixed-l"),tr.append(t)}for(let x of x_l)for(let xy of xy_h){let td=document.createElement("td");td.setAttribute("data-x-id",x),td.setAttribute("data-xy-id",xy);let f=eval(xy_f),xy_v=r[i].data[x][xy],result="";xy_v.length>0&&(result=f(xy_v)),td.textContent=""!==result?result:"-",tr.append(td)}}let but_tag=document.createElement("button");but_tag.id=tbl_id+"_button",tbl.hidden?but_tag.textContent="Show original table":but_tag.textContent="Hide original table",but_tag.onclick=()=>tbl.hidden?(tbl.hidden=!1,but_tag.textContent="Hide original table",!1):(tbl.hidden=!0,but_tag.textContent="Show original table",!1),tbl.insertAdjacentElement("beforebegin",but_tag),tbl.insertAdjacentElement("afterend",n_t),tbl_filter(n_t)}function pivot(e,t=""){let l=document.querySelectorAll('[id^="wx-form-id'+t+'"]')[0];l||(l=document.createElement("form"),l.name="wx-form-id"+t,l.classList.add("wx-form"),e.insertAdjacentElement("beforebegin",l));let n=get_heading(e),i=[{type:"select",label:"Row Index",items:n,name:"y_pv",multiple:!0},{type:"select",label:"Column Index",items:n,name:"x_pv"},{type:"select",label:"Data",items:n,name:"xy_pv",multiple:!0},{type:"select",name:"xyf_pv",label:"Aggfunc",items:["flat","mean","sum","max","min"],default:"sum"}],a=l.getElementsByTagName("button")[0];a?a.insertAdjacentElement("beforebegin",create_fs("Pivoting options",i)):l.append(create_fs("Pivoting options",i));var o=document.createElement("button");l.append(o),o.setAttribute("type","button"),o.setAttribute("id","form_"+t),o.textContent="Create Pivot table",o.onclick=l=>{let n=l.target.form,i=n.x_pv.value,a=[];for(let e of n.y_pv.selectedOptions)a.push(e.value);let o=[];for(let e of n.xy_pv.selectedOptions)o.push(e.value);let r=n.xyf_pv.value,s="wx-pivot"+t;document.getElementById(s)&&(document.getElementById(s).remove(),document.getElementById(s+"_button").remove()),pivot_table(e,i,a,o,r,s)}}function flat(e){return e.join("|")}function mean(e){return(e.reduce(((e,t)=>to_num(e)+to_num(t)),0)/e.length).toFixed(2)}function to_num(e){return e?"string"!=typeof e?e:Number(e.trim().replace(/[^0-9\.]/g,"")):null}function sum(e){return e.reduce(((e,t)=>to_num(e)+to_num(t)),0)}function max(e){return e.reduce(((e,t)=>Math.max(to_num(e),to_num(t))))}function min(e){return e.reduce(((e,t)=>Math.min(to_num(e),to_num(t))))}function create_fs(e="",t=[]){let l=document.createElement("fieldset");l.classList.add("wx-fieldset");let n=document.createElement("legend");n.textContent=e,l.append(n);let i=document.createElement("div");for(var a of(l.append(i),t)){let e=document.createElement("div");e.classList.add("wx-fs-item");let t=document.createElement("label");if(t.textContent=a.label,e.append(t),"select"==a.type){let t=document.createElement("select");if(t.name=a.name,a.multiple&&(t.multiple=!0,t.size=4),!a.default){let e=document.createElement("option");e.selected=!0,e.text="-",e.value="",t.add(e)}for(let e of a.items){let l=document.createElement("option");l.text=e,l.value=e,t.add(l),a.default&&a.default==e&&(l.selected=!0)}e.append(t)}if("checkbox"==a.type){let t=document.createElement("input");t.type="checkbox",t.name=a.name,e.append(t)}if("input"==a.type){let t=document.createElement("input");t.type="input",t.name=a.name,t.onkeydown=function(e){return"Enter"!=event.key},e.append(t)}i.append(e)}return l}function loadScript(e,t){let l=document.createElement("script");l.src=e,l.onload=()=>t(l),document.head.append(l)}__webpack_require__.d(__webpack_exports__,{cz:()=>set_style,P1:()=>get_heading,B3:()=>fix_table_heading,Io:()=>tbl_to_json,tF:()=>tbl_filter,m6:()=>create_fs,ve:()=>loadScript})}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,t)=>{for(var l in t)__webpack_require__.o(t,l)&&!__webpack_require__.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=__webpack_require__(435);let t="https://cdn.jsdelivr.net/npm/";function l(e,t){let l={};return t.is_col?(l.text=t.g+" plot of "+t.x+" vs "+t.y,"box"==t.g&&(l.text="Box plot of "+t.y)):l.text=t.g+" plot of "+t.x+" vs "+(""!=t.xg&&t.xg!=t.x?t.y:e[0].column)+(t.xg?" for each "+t.xg:""),t.f&&(l.subtitle="(Aggregated using "+t.f+")"),["scatter","hist","kde","cdf","summary"].includes(t.g)&&(l.text=t.g+" plot of "+(t.is_col?t.y:t.y[0])+(!t.is_col&&t.xg?" for different "+t.xg:"")),l}function n(e){let t={mark:"rule"};return t.encoding={y:{datum:parseFloat(e)},size:{value:1},color:{value:"red"}},t}function i(e,t){let l=new Set;for(let t of e)l.add(t.column);let n=[];n.push({field:"index",type:t.is_ts?"temporal":"ordinal",format:"%b %d, %Y %H:%M:%S"});for(let e of l)n.push({field:e});return{mark:{type:"rule"},transform:[{pivot:"column",value:"value",groupby:["index"]}],selection:{hover:{type:"single",on:"mouseover",nearest:!0,empty:"none",clear:"mouseout",fields:["index"]}},encoding:{x:{field:"index",type:"temporal"},opacity:{condition:{selection:"hover",value:"0.3"},value:0},tooltip:n}}}function a(e,t,l="black",n="quantitative",i={}){let a={};return a.mark={type:"text",align:"heatmap"==t.g?"center":"left",baseline:"middle",fontsize:14,dx:"heatmap"==t.g?0:3,angle:"heatmap"==t.g?0:-90},a.encoding={x:{field:"index"},y:{field:"column"},text:{field:"value",type:n},color:{value:l}},"bar"==t.g&&(a.encoding.y={field:"value",type:"quantitative"}),a}function o(e,t,l="line"){let n=[],i={};return i.mark={type:l,tooltip:null},i.encoding={x:{field:"index",type:"temporal",axis:{title:t.x}},y:{field:"value",type:"quantitative",axis:{title:t.y.join(",").slice(0,100)},stack:t.s},color:{field:"column",title:t.xg}},i.encoding.opacity={condition:{selection:"select",value:1},value:.2},i.selection={select:{type:"multi",fields:["column"],bind:"legend"}},n.push(i),n}function r(e,t){let l=[],n={transform:[{window:[{op:"lag",field:"value",as:"y1"}],groupby:["column"]},{calculate:"datum.value - (isValid(datum.y1) ? datum.y1 : datum.value)",as:"dy"}],mark:{type:"bar",tooltip:!0}};return n.encoding={x:{type:"temporal",field:"index"},y:{type:"quantitative",field:"dy",stack:t.s},color:{field:"column"}},n.encoding.opacity={condition:{selection:"select",value:1},value:.2},n.selection={select:{type:"multi",fields:["column"],bind:"legend"}},l.push(n),l}function s(e,t,l){let n={mark:{type:"bar",tooltip:!0},transform:[]},i="column";return"onside"==t.s&&(n.title=l,n.transform.push({filter:"datum.column == '"+l+"'"})),n.transform.push({bin:{maxbins:t.h},field:"value",as:"bin_value"},{aggregate:[{op:"count",as:"count"}],groupby:["bin_value","bin_value_end",i]},{joinaggregate:[{op:"sum",field:"count",as:"totalcount"}],groupby:[i]},{calculate:"datum.count/datum.totalcount",as:"percentoftotal"},{calculate:"toString(datum.bin_value) + '-' + datum.bin_value_end",as:"bin"}),n.encoding={x:{field:"bin_value",bin:{binned:!0}},x2:{field:"bin_value_end"},y:{type:"quantitative",field:"percentoftotal",axis:{format:".1~%"}},color:{field:i},opacity:{condition:{selection:"select",value:1},value:.1},tooltip:[{field:"bin"},{field:"count"},{field:"percentoftotal",format:".1~%"},{field:"column"}]},n.selection={select:{type:"multi",fields:["column"],bind:"legend"}},n}function d(e,t,l){let n={},i="column";return n.mark={type:"line",tooltip:!0},n.transform=[],"onside"==t.s&&(n.title=l,n.transform.push({filter:"datum.column == '"+l+"'"})),n.transform.push({density:"value",groupby:[i]}),n.encoding={x:{field:"value",type:"quantitative"},y:{field:"density",type:"quantitative"},color:{field:i},opacity:{condition:{selection:"select",value:1},value:.2}},n.selection={select:{type:"multi",fields:["column"],bind:"legend"}},n}function c(e,t,l){let n={},i="column";return n.mark={type:"line",tooltip:!0},n.transform=[],"onside"==t.s&&(n.title=l,n.transform.push({filter:"datum.column == '"+l+"'"})),n.transform.push({sort:[{field:"value"}],window:[{op:"cume_dist",field:"value",as:"Cumulative Count"}],frame:[null,0],groupby:[i]}),n.encoding={x:{field:"value",type:"quantitative"},y:{field:"Cumulative Count",type:"quantitative"},color:{field:i},opacity:{condition:{selection:"select",value:1},value:.2}},n.selection={select:{type:"multi",fields:["column"],bind:"legend"}},n}function u(e,t,l){let n={transform:[],mark:{type:"boxplot",extent:1.5,median:{color:"white"},ticks:!0}};if("onside"==t.s&&(n.title=l,n.transform.push({filter:"datum.column == '"+l+"'"})),t.is_col)var i="column";else i="index";return n.encoding={x:{field:i,type:"nominal"},y:{field:"value",type:"quantitative",scale:{zero:!1}},color:{field:i,type:"nominal"}},n}function p(e,t){let l=[],n=[];return n.width=900,n.mark={type:"point",filled:!0,tooltip:!t.is_col||null},n.encoding={x:{field:"index",type:t.is_ts?"temporal":"quantitative",scale:{zero:!1},title:t.x},y:{field:"value",type:"quantitative",title:t.y,scale:{zero:!1}},color:{field:"column",type:"nominal"}},n.selection={brush:{type:"interval"}},l.push(n),l}function f(e,t,l=!1){let n=[],i={};return i.encoding={x:{field:t.is_col?"column":"index",type:t.is_ts?"temporal":"ordinal",axis:{title:t.x}},y:{field:"value",type:"quantitative",axis:{title:t.y.join(",").slice(0,100)},stack:t.s},color:{field:"column",type:"nominal"},facet:{field:"column",columns:8}},i.mark={type:"bar",tooltip:!0},n.push(i),n}function m(t,m){(0,e.B3)(t);let h=(0,e.P1)(t);var x=document.createElement("form");x.name="wx-form_"+m,x.classList.add("wx-form"),x.id="wx-form-id"+m,x.append((0,e.m6)("Graph options",[{type:"select",label:"Graph type=",items:["bar","timeindex","timeindex_area","heatmap","circle","scatter","box","hist","lag","cdf","summary"],name:"g"},{type:"checkbox",label:"Visible rows",name:"incl"},{type:"select",label:"Stacking method=",items:["ontop","onside","overlap","normalize"],default:"ontop",name:"s"},{type:"select",label:"Aggregate method=",items:["average","sum","count","min","max"],name:"f",default:"sum"},{type:"input",label:"Horizontal axis Threshold/Hist Bin Count",name:"h"},{type:"checkbox",label:"annotate",name:"anno"}])),x.g.onchange=e=>{!function(e,t){for(let e of t)e.disabled=!1;t.s.disabled=!0,t.f.value="average",t.is_ts.disabled=!0,t.is_ts.checked=!1,"box"==e&&(t.f.disabled=!0,t.h.disabled=!0,t.anno.disabled=!0,t.is_col.disabled=!1,t.f.value=null,t.f.disabled=!0,t.s.disabled=!1),"hist"!=e&&"kde"!=e&&"cdf"!=e&&"summary"!=e||(t.f.value=null,t.f.disabled=!0,t.h.value=20,t.s.disabled=!1,t.anno.disabled=!0,t.is_col.disabled=!1,t.x.disabled=!0,t.x.value=null),"scatter"==e&&(t.f.disabled=!0,t.h.disabled=!0,t.anno.disabled=!0,t.is_ts.disabled=!1),"bar"==e&&(t.anno.diabled=!0,t.s.disabled=!1,t.is_ts.disabled=!1,t.is_col.disabled=!1),"heatmap"==e&&(t.h.disabled=!0,t.is_col.disabled=!1,t.is_ts.disabled=!1),"circle"==e&&(t.h.disabled=!0,t.f.value="sum",t.anno.disabled=!0,t.is_ts.disabled=!1,t.is_col.disabled=!1),"timeindex"!=e&&"timeindex_area"!=e&&"lag"!=e||(t.s.disabled=!1,t.is_col.disabled=!1,t.is_ts.checked=!0)}(x.g.value,x)};let g=[{type:"select",label:"Index/X-axis",items:h,name:"x"},{type:"select",label:"Values/Y-axis",items:h,name:"y",multiple:!0},{type:"select",label:"Grouping/Hue",items:h,name:"xg"},{type:"checkbox",label:"is index a time?",name:"is_ts"},{type:"input",label:"timeformat",name:"ts"},{type:"checkbox",label:"column oriented",name:"is_col"}];x.append((0,e.m6)("Data options",g));var b=document.createElement("button");x.append(b),t.insertAdjacentElement("beforebegin",x),b.setAttribute("type","button"),b.setAttribute("id","form_"+_),b.textContent="Graph table",b.onclick=h=>{let _=h.target.form,x=[];for(let e of _.y.selectedOptions)x.push(e.value);let g=_.incl.checked,b={x:_.x.value,y:x,g:_.g.value,y2:"",f:_.f.value,s:_.s.value,xg:_.xg.value,h:_.h.value,anno:_.anno.checked,is_ts:_.is_ts.checked,ts:_.ts.value,is_col:_.is_col.checked};!function(t,m,h,_){let x=(0,e.Io)(t,h);console.log("md passed",m),console.log("data passed",x);let g=[];g=function(e,t){let l=Object.keys(e[0]),n=[],i=l.filter((e=>!n.includes(e))),a=[],o=t.y,r=t.x,s=t.xg;if(t.anno,t.ts,t.is_col){console.log("columar data detected");for(let t of e)for(let e of o)a.push({column:e,value:parseFloat(t[e].replace(/[^0-9\.\-]/g,"")),index:t[r]})}else if(""!=s&&s!=r){console.log("grouping of data detected"),t.y=[t.y[0]];for(let t of e){let e={};e={index:t[r],column:t[s],value:parseFloat(t[o[0]].replace(/[^0-9\.\-]/g,""))};for(let l of i)e[l]=t[l];a.push(e)}}else{console.log("no grouping and no columnar data");for(let t of e){let e={};for(let l of o)e={index:t[r],column:l,value:parseFloat(t[l].replace(/[^0-9\.\-]/g,""))};for(let l of i)e[l]=t[l];a.push(e)}}return a}(x,m),console.log("data parsed",g);let b={$schema:"https://vega.github.io/schema/vega-lite/v4.json",title:l(g,m).text.slice(0,200),descripton:"vega-lite ad-hoc plotter",data:{values:g},transform:[],config:{view:{step:20},scale:{scheme:"category20"}},width:1200,height:400};if(["box","scatter","hist","kde","cdf","summary"].includes(m.g)||b.transform.push({aggregate:[{op:m.f,field:"value",as:"value"}],groupby:["index","column"]}),m.is_ts&&m.ts?b.transform.push({calculate:"timeParse(datum.index, '"+m.ts+"')",as:"index"}):!m.is_ts&&Number(g[0].index)?b.transform.push({calculate:"toNumber(datum.index)",as:"index"}):"scatter"!=m.g||m.is_ts||b.transform.push({calculate:"replace(datum.index,/[^0-9.-]/g,'')",as:"index"}),Number(g[0].column)&&b.transform.push({calculate:"toNumber(datum.column)",as:"column"}),m.s={ontop:!0,normalize:"normalize",overlap:!1,center:"center",onside:"onside"}[m.s],"heatmap"==m.g)b.layer=function(e,t){let l=[],n={mark:{type:"rect",tooltip:!0}};return n.encoding={x:{field:"index",type:"ordinal"},y:{field:"column",title:t.is_col?null:t.xg,type:"ordinal"},color:{field:"value",type:"quantitative",scale:{scheme:"lightmulti"}}},t.is_ts&&(n.encoding.x.axis={labelOverlap:!0}),l.push(n),l}(0,m),b.config={axis:{grid:!0,tickBand:"extent",gridOpacity:.3}},m.anno&&b.layer.push(a(0,m));else if("bar"==m.g)"onside"==m.s?(b.config={view:{stroke:"transparent"},axis:{domainWidth:1}},b.facet={column:{field:"column",title:m.xg}},b.spec={},b.spec.layer=f(0,m),m.h&&b.spec.layer.push(n(m.h)),m.anno&&b.spec.layer.push(a(0,m))):(b.layer=f(0,m),m.h&&b.layer.push(n(m.h)),!m.xg&&m.anno&&b.layer.push(a(0,m)));else if("timeindex"==m.g||"timeindex_area"==m.g){if("timeindex"==m.g)var y="line";else y="area";"onside"==m.s?(b.config={view:{stroke:"transparent"},axis:{domainWidth:1}},b.facet={column:{field:"column",title:m.xg}},b.spec={},b.spec.layer=o(0,m,y=y),m.h&&b.spec.layer.push(n(m.h)),b.spec.layer.push(i(g,m))):(b.layer=o(0,m,y=y),m.h&&b.layer.push(n(m.h)),b.layer.push(i(g,m)))}else if("circle"==m.g)b.layer=function(e,t){let l=[],n={mark:{type:"circle",opacity:.8,stroke:"black",strokeWidth:1,tooltip:!0}};return n.encoding={x:{field:"index",type:t.is_ts?"temporal":"ordinal",axis:{grid:"false"}},y:{field:"column",type:"nominal",title:t.is_col?null:t.xg},color:{field:"value",type:"quantitative",scale:{scheme:"lightmulti"}},size:{field:"value",type:"quantitative"}},l.push(n),l}(0,m);else if("scatter"==m.g){b.transform.push({window:[{op:"row_number",as:"row_number"}]}),b.resolve={legend:{color:"independent"}},b.vconcat=[],b.vconcat.push({layer:p(0,m)});let e={};if(e={transform:[{filter:{selection:"brush"}},{window:[{op:"rank",as:"rank"}]},{filter:{field:"rank",lt:10}}]},e.hconcat=[],!m.is_col){var v=Object.keys(x[0]);for(let t of v)e.hconcat.push({title:t,view:{strokeWidth:0},mark:"text",encoding:{text:{field:(w=t,w.replace(".","\\.")),type:"nominal"},y:{field:"row_number",type:"ordinal",axis:null}}})}b.vconcat.push(e)}else"hist"==m.g?"onside"==m.s?(b.height=200,b.width=200,b=Object.assign(b,function(e,t){let l={concat:[],columns:4},n=new Set;for(let t of e)n.add(t.column);for(let e of n)l.concat.push(s(0,t,e));return l}(g,m))):b=Object.assign(b,s(0,m)):"kde"==m.g?"onside"==m.s?(b.height=200,b.width=200,b=Object.assign(b,function(e,t){let l={concat:[],columns:4},n=new Set;for(let t of e)n.add(t.column);for(let e of n)l.concat.push(d(0,t,e));return l}(g,m))):b=Object.assign(b,d(0,m)):"cdf"==m.g?"onside"==m.s?(b.height=200,b.width=200,b=Object.assign(b,function(e,t){let l={concat:[],columns:4},n=new Set;for(let t of e)n.add(t.column);for(let e of n)l.concat.push(c(0,t,e));return l}(g,m))):(b.layer=[c(0,m)],b.layer.push(n(.95))):"box"==m.g?"onside"==m.s?(b.height=200,b.width=200,b=Object.assign(b,function(e,t){let l={concat:[],columns:4},n=new Set;for(let t of e)n.add(t.column);for(let e of n)l.concat.push(u(0,t,e));return l}(g,m))):b.layer=[u(0,m)]:"summary"==m.g?(b.hconcat=[],b.hconcat.push(function(e,t){let l={transform:[{aggregate:[]}],hconcat:[]},n="column",i=["count","min","max","average","variancep","stdevp","median"];for(let e of i)l.transform[0].aggregate.push({op:e,field:"value",as:e});l.transform[0].groupby=[n],l.transform.push({window:[{op:"row_number",as:"row_number"}]});let a=new Set;for(let t of e)a.add(t.column);l.hconcat.push({title:"Series",view:{strokeWidth:0},mark:"text",encoding:{text:{field:n,type:"nominal"},y:{field:"row_number",type:"ordinal",axis:null}}});for(let e of i)l.hconcat.push({title:e,view:{strokeWidth:0},mark:"text",encoding:{text:{field:e,type:"nominal",format:".2s"},y:{field:"row_number",type:"ordinal",axis:null}}});return l}(g)),b.hconcat.push(function(e,t){let l={},n=["0.75","0.90","0.95","0.99"];l.hconcat=[],l.transform=[{quantile:"value",probs:n,groupby:["column"],as:["prob","prob_value"]}],l.transform.push({pivot:"prob",groupby:["column"],value:"prob_value"}),l.transform.push({window:[{op:"row_number",as:"row_number"}]});for(let e of n)l.hconcat.push({title:"p"+e,view:{strokeWidth:0},mark:"text",encoding:{text:{field:"\\"+e,type:"nominal",format:".2s"},y:{field:"row_number",type:"ordinal",axis:null}}});return l}())):"lag"==m.g&&("onside"==m.s?(b.config={view:{stroke:"transparent"},axis:{domainWidth:1}},b.facet={column:{field:"column",title:m.xg}},b.spec={},b.spec.layer=r(0,m),m.h&&b.spec.layer.push(n(m.h))):(b.layer=r(0,m),m.h&&b.layer.push(n(m.h))));var w;console.log("Final spec",b),vegaEmbed("#viz"+_,b,{tooltip:{theme:"light"}}).then((e=>console.log(e))).catch(console.warn)}(t=t,b,g,m)};let y=document.createElement("div");y.id="viz"+m,y.style.width=t.offsetWidth,t.insertAdjacentElement("beforebegin",y)}(0,e.ve)(t+"vega@5",(function(l){(0,e.ve)(t+"vega-lite@4",(function(l){(0,e.ve)(t+"vega-embed@5",(function(e){console.log("Loaded all")}))}))})),(0,e.cz)();let h=document.getElementsByTagName("table"),_=0;for(let t of h)t.tBodies.length>0&&(_++,m(t,_),(0,e.tF)(t))})()})();

javascript:(()=>{"use strict";var __webpack_modules__={435:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function set_style(){let e=document.createElement("style"),t=".wx-fixed-t {position:sticky;top:0px;z-index:2}";t+=".wx-fixed-l {position:sticky;left:0px;z-index:2}",t+=".wx-fieldset {font-size: small; font-family: monospace; background: azure; border: 1px solid gray}",t+=".wx-form {width: max-content}",t+=".wx-fs-item {display: inline-grid; margin-right:10px}",t+='tr[class*="filter_hidden"] { display: none }',t+=".wx-pivot td {border: 1px solid grey; background-color: azure; padding:2px; white-space: nowrap}",t+=".wx-pivot table { color #363636; border-collapse: collapse; border-spacing: 0}",t+=".wx-pivot th {background-color: LightBlue; border: 1px solid grey; padding: 2px}",t+=".wx-pivot tbody tr:hover * {background-color: aliceblue}",e.innerHTML='.wx-fixed-t {position:sticky;top:0px;z-index:2}.wx-fixed-l {position:sticky;left:0px;z-index:2}.wx-fieldset {font-size: small; font-family: monospace; background: azure; border: 1px solid gray}.wx-form {width: max-content}.wx-fs-item {display: inline-grid; margin-right:10px}tr[class*="filter_hidden"] { display: none }.wx-pivot td {border: 1px solid grey; background-color: azure; padding:2px; white-space: nowrap}.wx-pivot table { color #363636; border-collapse: collapse; border-spacing: 0}.wx-pivot th {background-color: LightBlue; border: 1px solid grey; padding: 2px}.wx-pivot tbody tr:hover * {background-color: aliceblue}',document.head.append(e)}function get_heading(e){let t=e.children[0].children[0];return fix_table_heading(e),[...t.cells].map((e=>e.dataset.colName))}function fix_table_heading(e){let t=e.children[0].children[0];if(0==t.cells.length&&(t=e.children[0].children[1]),!t.classList.contains("wx-thead")){e.tHead||e.createTHead().appendChild(t),t.classList.add("wx-thead"),t.classList.add("wx-fixed-t"),t.style.zIndex=2;let l=t.cells;for(let e=0;e<l.length;e++)""==l[e].textContent&&(l[e].textContent="column"+e),l[e].setAttribute("data-col-name",l[e].textContent.replace("▾","").replace("▴","").trim())}let l=e.tBodies[0].rows,n=Math.min(l.length,3),i=[];for(let e=0;e<n;e++)(l[e].querySelector('a[title="Undo sorting"]')||l[e].querySelector('a[title="Sort alphabetically"]')||l[e].querySelector('a[title="Sort numerically"]')||l[e].querySelector('*[title="Sort Ascending"]')||l[e].querySelector('*[title="Sort Descending"]'))&&i.push(l[e]);i.forEach((t=>e.tHead.appendChild(t)))}function tbl_to_json(e,t=!1){let l=get_heading(e),n=e.tBodies[0].rows,i=[];for(let e=0;e<n.length;e++){let r={};if(0!=n[e].cells.length&&(1!=t||!n[e].className.includes("filter_hidden"))){for(let t=0;t<l.length;t++)r[l[t]]=n[e].cells[t].textContent;i.push(r)}}return i}function tbl_filter(e){fix_table_heading(e);var t=e.tHead.children[0].children;let l=Math.floor(100*Math.random()),n=document.createElement("caption");n.style.textAlign="left",n.style.fontFamily="monospace",e.appendChild(n);for(let n=0;n<t.length;n++){var i=document.createElement("input");let a=t[n].offsetWidth||50;i.style.width=a+"px",i.setAttribute("type","text"),i.setAttribute("placeholder","matches"),i.setAttribute("id","rf_id_"+n+"_"+l),i.onkeyup=function(t){13==t.keyCode&&(this.style.width=Math.max(11*this.value.length+6,45)+"px",filter_rows(e,this.value,n))},i.onkeydown=function(e){if(13==e.keyCode)return e.stopPropagation(),!1},i.onclick=function(e){e.stopPropagation()};var r=document.createElement("span");r.className="wx-thead-span",t[n].style.position="sticky",t[n].style.top="0px","rgba(0, 0, 0, 0)"==window.getComputedStyle(t[n],null).getPropertyValue("background-color")&&(t[n].style.backgroundColor="Gainsboro"),t[n].appendChild(i),t[n].appendChild(r)}}function filter_rows(e,t,l=0){let n=e.tBodies[0].children,i=[],r=[];fix_table_heading(e);let a=e.tHead.children[0].children,o="";for(let t=0;t<a.length;t++){let l=a[t].getElementsByTagName("input")[0].value;l.trim()?o+=" ["+a[t].firstChild.textContent+":"+l+"]":(r.push(t),e.tHead.children[0].children[t].querySelector(".wx-thead-span").textContent="")}for(let e=0;e<n.length;e++){for(let r of t.toLowerCase().split("|")){let t=n[e].children[l].textContent.toLowerCase().trim();if(r.startsWith("<")){let a=r.split("<")[1];t=t.replace(/[^0-9\.]/g,""),Number(t)<Number(a)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(r.startsWith(">")){t=t.replace(/[^0-9\.]/g,"");let a=r.split(">")[1];Number(t)>Number(a)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(r.startsWith("^")){let a=r.split("^")[1].toLowerCase();t.startsWith(a)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(r.startsWith("$")){let a=r.split("$")[1].toLowerCase();t.endsWith(a)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(r.startsWith("!")){let a=r.split("!")[1].toLowerCase();t.includes(a)||(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else if(r.startsWith("="))t==r.split("=")[1]&&(n[e].classList.remove("filter_hidden_"+l),i.push(e));else if(r.startsWith("@[")){let a=r.split("@[")[1].replace("]",""),o=Number(a.split(",")[0]),d=Number(a.split(",")[1]);t=Number(t.replace(/[^0-9\.]/g,"")),t>=o&&t<=d&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}else t.includes(r)&&(n[e].classList.remove("filter_hidden_"+l),i.push(e))}i.includes(e)||n[e].classList.add("filter_hidden_"+l),r.forEach((t=>{n[e].classList.remove("filter_hidden_"+t)}))}e.tHead.children[0].children[l].querySelector(".wx-thead-span").textContent="="+i.length;let d=n.length-e.tBodies[0].querySelectorAll('tr[class*="filter_hidden"]').length;e.caption.textContent="Total "+d+" rows visible; Filters ="+o}function pivot_table(tbl,x_h=[],y_h,xy_h,xy_f="flat",tbl_id=""){fix_table_heading(tbl);let h_l=get_heading(tbl),d=tbl.tBodies[0].rows,t_d=[];for(let e=0;e<d.length;e++){let t={};for(let l=0;l<h_l.length;l++)t[h_l[l]]=d[e].cells[l].textContent;t_d.push(t)}tbl.id+=" wx-orig"+tbl_id;let rest=h_l;rest=rest.filter((e=>e!=y_h&&e!=x_h)),rest=rest.filter((e=>!xy_h.includes(e)));let x_set=new Set;t_d.forEach((e=>{x_set.add(e[x_h])}));let x_l=[...x_set],y_d={};for(let e of y_h)y_d[e]=new Set,t_d.forEach((t=>{y_d[e].add(t[e])})),y_d[e]=[...y_d[e]];let r=new Map;for(let e of t_d){let t=[];for(let l of y_h)t.push(e[l]);r[t]||(r[t]={y:t,data:{},rest:{}});for(let l of rest)r[t].rest[l]||(r[t].rest[l]=new Set),r[t].rest[l].add(e[l]);for(let l of x_l){r[t].data[l]||(r[t].data[l]={});for(let n of xy_h)r[t].data[l][n]||(r[t].data[l][n]=[]),e[x_h]==l&&r[t].data[l][n].push(e[n])}}function filter_cols(e,t){let l=new Set;for(let n of t)if(""==e.trim())document.querySelectorAll('*[data-x-id="'+n+'"]').forEach((e=>e.hidden=!1));else{document.querySelectorAll('*[data-x-id="'+n+'"]').forEach((e=>e.hidden=!0));for(let n of e.split("|"))n.startsWith("^")?t.filter((e=>e.startsWith(n.split("^")[1]))).forEach(l.add,l):n.startsWith("$")?t.filter((e=>e.endsWith(n.split("$")[1]))).forEach(l.add,l):n.startsWith("!")?t.filter((e=>e!=n.split("!")[1])).forEach(l.add,l):n.startsWith("=")?t.filter((e=>e==n.split("=")[1])).forEach(l.add,l):t.filter((e=>e.toLowerCase().includes(n.toLowerCase()))).forEach(l.add,l)}if(l=[...l],""==!e.trim())for(let e of l)document.querySelectorAll('*[data-x-id="'+e+'"]').forEach((e=>e.hidden=!1))}let n_t=document.createElement("table");n_t.id=tbl_id,n_t.classList.add("wx-pivot");let th=n_t.createTHead();th.classList.add("wx-fixed-t");let thr1=th.insertRow();for(let e of y_h){let t=document.createElement("th");t.textContent=e,t.classList.add("wx-fixed-l"),t.classList.add("wx-fixed-t"),t.style.zIndex=3,thr1.appendChild(t)}let head_colspan=xy_h.length;for(let e of x_l){let t=document.createElement("th");t.setAttribute("colspan",head_colspan),t.setAttribute("data-x-id",e),t.classList.add("wx-fixed-t"),t.textContent=e,thr1.appendChild(t)}let thr2=th.insertRow(),thd=document.createElement("th");thd.setAttribute("colspan",y_h.length);var div=document.createElement("div"),span=document.createElement("span");span.textContent=x_h,div.appendChild(span);var cf_ip=document.createElement("input");div.appendChild(cf_ip),cf_ip.setAttribute("type","text"),cf_ip.setAttribute("placeholder",x_h+" matches"),cf_ip.setAttribute("id","x_id"),cf_ip.classList.add("wx-input-cf"),cf_ip.onkeyup=function(e){13==e.keyCode&&filter_cols(this.value,x_l)},cf_ip.onkeydown=function(e){if(13==e.keyCode)return!1},thd.append(div),thr2.append(thd);for(let e=0;e<x_l.length;e++)for(let t of xy_h){let l=document.createElement("th");l.setAttribute("data-x-id",x_l[e]),l.setAttribute("data-xy-id",t),l.textContent=t,thr2.appendChild(l)}let tb=document.createElement("tbody");n_t.appendChild(tb);for(let i in r){let tr=document.createElement("tr");tb.appendChild(tr);for(let e of r[i].y){let t=document.createElement("td");t.textContent=e,t.classList.add("wx-fixed-l"),tr.append(t)}for(let x of x_l)for(let xy of xy_h){let td=document.createElement("td");td.setAttribute("data-x-id",x),td.setAttribute("data-xy-id",xy);let f=eval(xy_f),xy_v=r[i].data[x][xy],result="";xy_v.length>0&&(result=f(xy_v)),td.textContent=""!==result?result:"-",tr.append(td)}}let but_tag=document.createElement("button");but_tag.id=tbl_id+"_button",tbl.hidden?but_tag.textContent="Show original table":but_tag.textContent="Hide original table",but_tag.onclick=()=>tbl.hidden?(tbl.hidden=!1,but_tag.textContent="Hide original table",!1):(tbl.hidden=!0,but_tag.textContent="Show original table",!1),tbl.insertAdjacentElement("beforebegin",but_tag),tbl.insertAdjacentElement("afterend",n_t),tbl_filter(n_t)}function pivot(e,t=""){let l=document.querySelectorAll('[id^="wx-form-id'+t+'"]')[0];l||(l=document.createElement("form"),l.name="wx-form-id"+t,l.classList.add("wx-form"),e.insertAdjacentElement("beforebegin",l));let n=get_heading(e),i=[{type:"select",label:"Row Index",items:n,name:"y_pv",multiple:!0},{type:"select",label:"Column Index",items:n,name:"x_pv"},{type:"select",label:"Data",items:n,name:"xy_pv",multiple:!0},{type:"select",name:"xyf_pv",label:"Aggfunc",items:["flat","mean","sum","max","min"],default:"sum"}],r=l.getElementsByTagName("button")[0];r?r.insertAdjacentElement("beforebegin",create_fs("Pivoting options",i)):l.append(create_fs("Pivoting options",i));var a=document.createElement("button");l.append(a),a.setAttribute("type","button"),a.setAttribute("id","form_"+t),a.textContent="Create Pivot table",a.onclick=l=>{let n=l.target.form,i=n.x_pv.value,r=[];for(let e of n.y_pv.selectedOptions)r.push(e.value);let a=[];for(let e of n.xy_pv.selectedOptions)a.push(e.value);let o=n.xyf_pv.value,d="wx-pivot"+t;document.getElementById(d)&&(document.getElementById(d).remove(),document.getElementById(d+"_button").remove()),pivot_table(e,i,r,a,o,d)}}function flat(e){return e.join("|")}function mean(e){return(e.reduce(((e,t)=>to_num(e)+to_num(t)),0)/e.length).toFixed(2)}function to_num(e){return e?"string"!=typeof e?e:Number(e.trim().replace(/[^0-9\.]/g,"")):null}function sum(e){return e.reduce(((e,t)=>to_num(e)+to_num(t)),0)}function max(e){return e.reduce(((e,t)=>Math.max(to_num(e),to_num(t))))}function min(e){return e.reduce(((e,t)=>Math.min(to_num(e),to_num(t))))}function create_fs(e="",t=[]){let l=document.createElement("fieldset");l.classList.add("wx-fieldset");let n=document.createElement("legend");n.textContent=e,l.append(n);let i=document.createElement("div");for(var r of(l.append(i),t)){let e=document.createElement("div");e.classList.add("wx-fs-item");let t=document.createElement("label");if(t.textContent=r.label,e.append(t),"select"==r.type){let t=document.createElement("select");if(t.name=r.name,r.multiple&&(t.multiple=!0,t.size=4),!r.default){let e=document.createElement("option");e.selected=!0,e.text="-",e.value="",t.add(e)}for(let e of r.items){let l=document.createElement("option");l.text=e,l.value=e,t.add(l),r.default&&r.default==e&&(l.selected=!0)}e.append(t)}if("checkbox"==r.type){let t=document.createElement("input");t.type="checkbox",t.name=r.name,e.append(t)}if("input"==r.type){let t=document.createElement("input");t.type="input",t.name=r.name,e.append(t)}i.append(e)}return l}function loadScript(e,t){let l=document.createElement("script");l.src=e,l.onload=()=>t(l),document.head.append(l)}__webpack_require__.d(__webpack_exports__,{cz:()=>set_style,tF:()=>tbl_filter})}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,t)=>{for(var l in t)__webpack_require__.o(t,l)&&!__webpack_require__.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=__webpack_require__(435);(0,e.cz)();var t=document.getElementsByTagName("table");for(var l of t)try{(0,e.tF)(l)}catch(e){console.log(e)}})()})();
